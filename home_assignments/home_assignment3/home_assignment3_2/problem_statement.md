# Практична робота 3.2

Тема - структури та керування пам'яттю.

Терміни здачі - до 31-го грудня 2023р. включно.

Кількість балів - 15.

Для заліку роботи додайте файл `main.c` з розв'язком задачі до відповідного завдання в Moodle.

Для перевірки свого рішення запустіть скрипт `test.cmd` або `make test` в залежності від вашої ОС.

## Умова задачі

Написати програму, що отримує перелік вищих навчальних закладів України в CSV форматі, підраховує дистанцію до кожного з них від головного корпусу МКУ та виводить ВНЗ упорядковані за нею.

### Формат вхідних даних

Вхідний потік містить довільну кількість рядків.
Кожен рядок описує один ВНЗ та містить наступну інформацію розділену точкою з комою:

* назва ВНЗ
* рік заснування
* оф. веб сайт
* широта в градусах, дійсне число
* довгота в градусах, дійсне число

, наприклад

```
Private higher educational institution Pylyp Orlyk International Classical University;2012;www.mku.edu.ua;46.9714764;32.01839468478296
```

Довжина кожного рядка не більша за 255 символів.

### Формат вихідних даних

Програма має вивести на екран перелік ВНЗ упорядкований за зростанням відстані до головного корпусу МКУ (координати 46.9714764, 32.01839468478296).
Кожен вихідний рядок описує один ВНЗ та містить наступну інформацію розділену точкою з комою:

* назва ВНЗ
* відстань в кілометрах округленa до найменшого цілого, натуральне число
* широта в градусах, дійсне число
* довгота в градусах, дійсне число

, наприклад

```
Private higher educational institution Pylyp Orlyk International Classical University;0;46.9714764;32.01839468478296
```

Якщо два ВНЗ мають однакову відстань, тоді вони мають бути виведені в алфавітному порядку.

**Увага** Координати ВНЗ на виході мають співпадати з кооринатами на вході. Для запобігання втрати точності при конвертації текстового рядка з дійсним числом в значення типу double і назад краще зберігати в пам'яті координати як текстовий рядок.

### Приклад 1

#### Ввід

```
Private higher educational institution Pylyp Orlyk International Classical University;2012;www.mku.edu.ua;46.9714764;32.01839468478296
```

#### Вивід

```
Private higher educational institution Pylyp Orlyk International Classical University;0;46.9714764;32.01839468478296
```

### Приклад 2:

#### Ввід

```
National University of Kyiv-Mohyla Academy;1991;http://www.ukma.edu.ua;50.465614349999996;30.52038751888054
State University Uzhhorod National University;1945;http://www.uzhnu.edu.ua;48.62584645;22.30348841735823
Transcarpathian Academy of Art;2003;artedu.uz.ua;48.60318675;22.285608270374475
Private higher educational institution Pylyp Orlyk International Classical University;2012;www.mku.edu.ua;46.9714764;32.01839468478296
```

#### Вивід

```
Private higher educational institution Pylyp Orlyk International Classical University;0;46.9714764;32.01839468478296
National University of Kyiv-Mohyla Academy;403;50.465614349999996;30.52038751888054
State University Uzhhorod National University;748;48.62584645;22.30348841735823
Transcarpathian Academy of Art;748;48.60318675;22.285608270374475
```

Дивіться інші приклади в директорії `tests`.

## Методичні вказівки

### Загальний алгоритм програми

1. Прочитати кожен вхідний рядок, розкласти його на складові та зберегти їх в структурі. 
2. Для кожного запису, порахувати відстань.
3. Відсортувати масив структур за відстаню та іменем ВНЗ.
4. Вивести результат.

### Обчислення дистанції між географічними координатами

Для обчислення дистанції між координатами використовуємо спрощенну модель Земної кулі та формулу гаверсинусу.

Вікіпедія: [Формула гаверсинуса](https://uk.wikipedia.org/wiki/%D0%A4%D0%BE%D1%80%D0%BC%D1%83%D0%BB%D0%B0_%D0%B3%D0%B0%D0%B2%D0%B5%D1%80%D1%81%D0%B8%D0%BD%D1%83%D1%81%D0%B0)

Для запобігання неточностей в розрахунках, використовуємо наступну реалізацію формули мовою C:

```
#include <math.h>

#define PI 3.14159265358979323846

unsigned haversine(double lat1, double lon1, double lat2, double lon2)
{
    lat1 = lat1 * PI / 180.0;
    lon1 = lon1 * PI / 180.0;
    lat2 = lat2 * PI / 180.0;
    lon2 = lon2 * PI / 180.0;

    double dlon = lon2 - lon1;
    double dlat = lat2 - lat1;
    double a = (sin(dlat / 2.0) * sin(dlat / 2.0)) +
        cos(lat1) * cos(lat2) * (sin(dlon / 2.0) * sin(dlon / 2.0));
    double c = 2.0 * asin(sqrt(a));
    double r = 6371.0;

    return (unsigned)floor(c * r);
}
```

### Представлення ВНЗ в пам'яті

Для представлення ВНЗ в пам'яті програми, зручно використовувати структури (struct) мови C.

При розділенні вхідного текстового рядка на поля, пам'ятайте що текстові рядки мають завершуватись нульовим символом.

Оскільки за умовою задачі нам відома максимальна довжина одного вхідного рядка, то для збереження полів одного ВНЗ в структурі можна скористатись масивами `char` фіксованого розміру.

### Збереження всіх ВНЗ в пам'яті

Оскільки кількість ВНЗ зазделегідь не відома, для збереження їх в пам'яті необхідно скористатись динамічним масивом.

### Сортування масиву ВНЗ за дистанцією

Для сортування масиву, нема необхідності реалізовувати самостійно алгоритм сортування, достатньо використати стандартну функцію `qsort`.

### Корисні функції для роботи з текстовими рядками

* `fgets` - для отримання одного рядка зі стандартного вводу незалежно від його формату.
* `strtod` - для конвертації текстового рядка в дійсне число типу double.
* `strchr` - для пошуку символа в текстовому рядку.
* `strcmp` - для порівняння двох текстових рядків за алфівітом.
* `memcpy` - для копіювання даних довільної довжини в пам'яті.

